[
	{
	"verb" : "write",
	"content" : {
			"name": "pgidev",
			"description": "Cost by Carrier and Call Type",
			"tenantId": "ABC",
			"productId": "ABC",
			"emailId": "ABC",
			"publishedBy": "ABC",
			"copyToFTP": true,
			"attachAnalysisToMail": true,
			"isScheduled": true,
			"outputFile": {
					"outputFormat": "parquet",
					"outputFileName": "DB"
			},
			"analysis": {
					"analysisId": 4,
					"productViewsId": 1,
					"analysisCategoryId": 3,
					"analysisCategoryName": "UA_RRM",
					"tenantId": "ATT",
					"productId": "none",
					"analysisName": "ABC",
					"analysisDescription": "Cost by Carrier and Call Typ",
					"analysisQuery": "SELECT tbl1.orig_date._xdfDate as CALL_DATE,ACCOUNT_NUMBER,VENDOR_NAME,REGION,CURRENCY,CALL_TYPE,ACCESS_TYPE,\n      ROUND((SUM(CAST(elapsed_time AS NUMERIC(9,2)))))  AS TOTAL_SWITCH_MOU ,(SUM(CAST(TOTAL_COST AS NUMERIC(19,4))))  AS Total_Cost\nFROM `data/VRUF` as tbl1 \nWHERE  tbl1.orig_date._xdfDate  Between ? \nGROUP BY VENDOR_NAME,ACCOUNT_NUMBER,REGION,tbl1.orig_date._xdfDate,CURRENCY,CALL_TYPE,ACCESS_TYPE",
					"analysisQueryType": "VIEW",
					"displayStatus": "A",
					"designerQuery": true,
					"createdUser": "srya0001",
					"modifiedUser": "srya0001",
					"createdDate": "2015-11-13 07:20:50",
					"modifiedDate": "2015-11-13 07:20:50",
					"parameters": [
							{
									"defaultValue": "today",
									"name": "orig_date",
									"type": "Date_Range",
									"value": "",
									"display": "Date",
									"optional": true,
									"index": 1,
									"rawAnalysisId": "",
									"rawAnalysisParametersId": "",
							}
					],
					"columns": [
							
							
(24,4,'LEFT','Call Date','CALL_DATE','Call Date',NULL,'100','Date_Range','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(25,4,'LEFT','Account Number','ACCOUNT_NUMBER','Account Number',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(26,4,'LEFT','Vendor Name','VENDOR_NAME','Vendor Name',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(27,4,'LEFT','Region','REGION','Region',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(28,4,'LEFT','Currency','CURRENCY','Currency',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(29,4,'LEFT','Call Type','CALL_TYPE','Call Type',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(30,4,'LEFT','Access Type','ACCESS_TYPE','Access Type',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(31,4,'LEFT','MOU','TOTAL_SWITCH_MOU','MOU',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),\
(32,4,'LEFT','Total Cost','Total_Cost','Total Cost',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
							{
									"align": "ABC",
									"label": "ABC",
									"name": "ABC",
									"pattern": "ABC",
									"size": "ABC",
									"type": "ABC",
									"aggregate": "ABC",
									"sortType": "ABC",
									"groupBy": "ABC",
									"criteria": "ABC",
									"alias": "ABC",
									"viewName": "ABC",
									"criteriaOption": "ABC",
									"renderCriteria": "ABC",
									"rawAnalysisId": 123,
									"rawAnalysisColumnsId": 123,
									"selected": true,
							}
					],
					"parametarised": true,
					"scheduled": true,
					"analysisSuperCategoryList": [
							"ABC"
					]
			}
		}
	}, 
// 2	
	{
	"verb" : "write",
	"content" : {
			"name": "ABC",
			"description": "ABC",
			"tenantId": "ABC",
			"productId": "ABC",
			"emailId": "ABC",
			"publishedBy": "ABC",
			"copyToFTP": true,
			"attachAnalysisToMail": true,
			"isScheduled": true,
			"outputFile": {
					"outputFormat": "ABC",
					"outputFileName": "ABC"
			},
			"analysis": {
(5,1,3,'pgidev','UA_RRM','Cost by Carrier and Region','Cost by Carrier and Region','SELECT tbl1.orig_date._xdfDate as CALL_DATE,ACCOUNT_NUMBER,VENDOR_NAME,REGION,\nCURRENCY ,\nROUND((SUM(CAST(elapsed_time AS NUMERIC(9,2)))))  AS TOTAL_SWITCH_MOU ,(SUM(CAST(TOTAL_COST AS NUMERIC(19,4))))  AS Total_Cost\nFROM `data/VRUF` as tbl1 \nWHERE   tbl1.orig_date._xdfDate Between ?   \nGROUP BY VENDOR_NAME,ACCOUNT_NUMBER,REGION,tbl1.orig_date._xdfDate,CURRENCY','VIEW','Y','N','sysadmin@pgidev.com','sysadmin@pgidev.com','2015-11-13 07:25:52','2015-11-13 07:25:52',NULL),
			
					"analysisId": 123,
					"productViewsId": 123,
					"analysisCategoryId": 123,
					"analysisCategoryName": "ABC",
					"tenantId": "ABC",
					"productId": "ABC",
					"analysisName": "ABC",
					"analysisDescription": "ABC",
					"analysisQuery": "ABC",
					"analysisQueryType": "ABC",
					"displayStatus": "ABC",
					"designerQuery": true,
					"createdUser": "ABC",
					"modifiedUser": "ABC",
					"createdDate": "ABC",
					"modifiedDate": "ABC",
					"parameters": [
							{
(7,5,'','','orig_date','Date_Range',NULL,'Call Date','0',1),
							
									"defaultValue": "ABC",
									"name": "ABC",
									"type": "ABC",
									"value": "ABC",
									"display": "ABC",
									"optional": true,
									"index": 123,
									"rawAnalysisId": 123,
									"rawAnalysisParametersId": 123,
									"lookupValue": "ABC",
									"lookup": [
											{
													"value": "ABC"
											}
									]
							}
					],
					"columns": [
(33,5,'LEFT','Call Date','orig_date','Call Date',NULL,'100','Date_Range','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(34,5,'LEFT','Account Number','ACCOUNT_NUMBER','Account Number',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(35,5,'LEFT','Vendor Name','VENDOR_NAME','Vendor Name',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(36,5,'LEFT','Region','REGION','Region',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(37,5,'LEFT','Currency','CURRENCY','Currency',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(38,5,'LEFT','MOU','TOTAL_SWITCH_MOU','MOU',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(39,5,'LEFT','Total Cost','Total_Cost','Total Cost',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),

					{
							
							
									"align": "ABC",
									"label": "ABC",
									"name": "ABC",
									"pattern": "ABC",
									"size": "ABC",
									"type": "ABC",
									"aggregate": "ABC",
									"sortType": "ABC",
									"groupBy": "ABC",
									"criteria": "ABC",
									"alias": "ABC",
									"viewName": "ABC",
									"criteriaOption": "ABC",
									"renderCriteria": "ABC",
									"rawAnalysisId": 123,
									"rawAnalysisColumnsId": 123,
									"selected": true,
							}
					],
					"parametarised": true,
					"scheduled": true,
					"analysisSuperCategoryList": [
							"ABC"
					]
			}
		}
	}, 
// 3 
	{
	"verb" : "write",
	"content" : {
			"name": "ABC",
			"description": "ABC",
			"tenantId": "ABC",
			"productId": "ABC",
			"emailId": "ABC",
			"publishedBy": "ABC",
			"copyToFTP": true,
			"attachAnalysisToMail": true,
			"isScheduled": true,
			"outputFile": {
					"outputFormat": "ABC",
					"outputFileName": "ABC"
			},
			"analysis": {
(6,1,3,'pgidev','UA_RRM','Cost by Vendor and Region NAM','Cost by Vendor and Region NAM','SELECT tbl1.orig_date._xdfDate as CALL_DATE,ACCOUNT_NUMBER,VENDOR_NAME,REGION,CURRENCY,\n   ROUND((SUM(CAST(elapsed_time AS NUMERIC(9,2)))))  AS TOTAL_SWITCH_MOU ,(SUM(CAST(TOTAL_COST AS NUMERIC(19,4))))  AS Total_Cost \nFROM `data/VRUF` as tbl1\nWHERE   \ntbl1.orig_date._xdfDate between ? \nand  UPPER(LTRIM(RTRIM(REGION))) =\'US\'\nGROUP BY ACCOUNT_NUMBER,VENDOR_NAME,CURRENCY,REGION,tbl1.orig_date._xdfDate','VIEW','Y','N','sysadmin@pgidev.com','sysadmin@pgidev.com','2015-11-13 07:30:17','2015-11-13 07:30:17',NULL),
			
					"analysisId": 123,
					"productViewsId": 123,
					"analysisCategoryId": 123,
					"analysisCategoryName": "ABC",
					"tenantId": "ABC",
					"productId": "ABC",
					"analysisName": "ABC",
					"analysisDescription": "ABC",
					"analysisQuery": "ABC",
					"analysisQueryType": "ABC",
					"displayStatus": "ABC",
					"designerQuery": true,
					"createdUser": "ABC",
					"modifiedUser": "ABC",
					"createdDate": "ABC",
					"modifiedDate": "ABC",
					"parameters": [
(8,6,'','','orig_date','Date_Range',NULL,'Call Date','0',1),
					
							{
									"defaultValue": "ABC",
									"name": "ABC",
									"type": "ABC",
									"value": "ABC",
									"display": "ABC",
									"optional": true,
									"index": 123,
									"rawAnalysisId": 123,
									"rawAnalysisParametersId": 123,
									"lookupValue": "ABC",
									"lookup": [
											{
													"value": "ABC"
											}
									]
							}
					],
					"columns": [
					
(40,6,'LEFT','Call Date','orig_date','Call Date',NULL,'100','Date_Range','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(41,6,'LEFT','Account Number','ACCOUNT_NUMBER','Account Number',NULL,'100','string','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(42,6,'LEFT','Vendor Name','VENDOR_NAME','Vendor Name',NULL,'100','string','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(43,6,'LEFT','Region','REGION','Region',NULL,'100','string','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(44,6,'LEFT','Currency','CURRENCY','Currency',NULL,'100','string','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(45,6,'LEFT','MOU','TOTAL_SWITCH_MOU','MOU',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(46,6,'LEFT','Total Cost','Total_Cost','Total Cost',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL)					
							{
									"align": "ABC",
									"label": "ABC",
									"name": "ABC",
									"pattern": "ABC",
									"size": "ABC",
									"type": "ABC",
									"aggregate": "ABC",
									"sortType": "ABC",
									"groupBy": "ABC",
									"criteria": "ABC",
									"alias": "ABC",
									"viewName": "ABC",
									"criteriaOption": "ABC",
									"renderCriteria": "ABC",
									"rawAnalysisId": 123,
									"rawAnalysisColumnsId": 123,
									"selected": true,
							}
					],
					"parametarised": true,
					"scheduled": true,
					"analysisSuperCategoryList": [
							"ABC"
					]
			}
		}
	},
	
// 4 
	{
	"verb" : "write",
	"content" : {	
	
				"name": "ABC",
				"description": "ABC",
				"tenantId": "ABC",
				"productId": "ABC",
				"emailId": "ABC",
				"publishedBy": "ABC",
				"copyToFTP": true,
				"attachAnalysisToMail": true,
				"isScheduled": true,
				"outputFile": {
						"outputFormat": "ABC",
						"outputFileName": "ABC"
				},
				"analysis": {
				
(7,1,3,'pgidev','UA_RRM','Fraud Monitor Report','Fraud Monitor Report','\nSELECT  \nMAIN.orig_date._xdfDate            						 	AS Call_Date,\nMAIN.VENDOR_NAME                         					 	AS Vendor_Name,\nMAIN.FROM_COUNTRY_NAME                   					 	AS Country,\n(CAST(MAIN.BTN AS VARCHAR(50))) 					AS Billing_Telephone_Number,\nCAST(MAIN.TO_TN AS BIGINT)                            				AS Called_Number,\nMAIN.CURRENCY                           					 	AS Currency ,\nCAST((COUNT(*)) AS BIGINT)                            				AS Call_Count,\nROUND((SUM(CAST(MAIN.elapsed_time AS NUMERIC(9,2)))))              AS Minutes_of_Usage,\n(SUM(CAST(MAIN.TOTAL_COST AS NUMERIC(19,4))))               AS Charge_in_Local_Currency,\nCUR.CONVERSION_RATE                     						AS FX_Rate,\nCAST((CAST((SUM(MAIN.TOTAL_COST*CUR.CONVERSION_RATE))AS DOUBLE)) AS NUMERIC(19,4))      AS Charge_in_USD\nFROM\n  `data/VRUF` as MAIN \nJOIN \n(SELECT * FROM `ref/CURRENCYCONVERSION` as RE WHERE STATUS=1 ) CUR\nON(COALESCE((CAST(MAIN.CURRENCY AS VARCHAR)),\'\') = COALESCE((CAST(CUR.BASE_CURRENCY_COUNTRY_CODE AS VARCHAR)),\'\'))\n\nWHERE MAIN.orig_date._xdfDate BETWEEN ? \nand (UPPER((LTRIM(RTRIM(MAIN.VENDOR_NAME)))) LIKE \'%\'||LTRIM(RTRIM(UPPER(?)))||\'%\' ) \nand(UPPER((LTRIM(RTRIM(MAIN.BTN)))) LIKE \'%\'||LTRIM(RTRIM(UPPER(?)))||\'%\' ) \nand(UPPER((LTRIM(RTRIM(MAIN.TO_TN)))) LIKE \'%\'||LTRIM(RTRIM(UPPER(?)))||\'%\' ) \nand (UPPER((LTRIM(RTRIM(MAIN.FROM_COUNTRY_NAME)))) LIKE \'%\'||LTRIM(RTRIM(UPPER(?)))||\'%\' ) \nGROUP BY\nMAIN.orig_date._xdfDate,\nMAIN.VENDOR_NAME,\nMAIN.FROM_COUNTRY_NAME,\n(CAST(MAIN.BTN AS VARCHAR(50))),\nCAST(MAIN.TO_TN AS BIGINT) ,\nCUR.CONVERSION_RATE,\nMAIN.CURRENCY','VIEW','Y','N','sysadmin@pgidev.com','sysadmin@pgidev.com','2015-11-13 07:35:19','2015-11-13 07:35:19',NULL),
				
						"analysisId": 123,
						"productViewsId": 123,
						"analysisCategoryId": 123,
						"analysisCategoryName": "ABC",
						"tenantId": "ABC",
						"productId": "ABC",
						"analysisName": "ABC",
						"analysisDescription": "ABC",
						"analysisQuery": "ABC",
						"analysisQueryType": "ABC",
						"displayStatus": "ABC",
						"designerQuery": true,
						"createdUser": "ABC",
						"modifiedUser": "ABC",
						"createdDate": "ABC",
						"modifiedDate": "ABC",
						"parameters": [

(9,7,'','','orig_date','Date_Range',NULL,'Call Date','0',1),
(10,7,'','','VENDOR_NAME','String',NULL,'Vendor Name','1',2),
(11,7,'','','BTN','String',NULL,'BTN','1',3),
(12,7,'','','TO_TN','String',NULL,'Called Number','1',4),
(13,7,'','','FROM_COUNTRY_NAME','String',NULL,'Country','1',5),						
								{
										"defaultValue": "ABC",
										"name": "ABC",
										"type": "ABC",
										"value": "ABC",
										"display": "ABC",
										"optional": true,
										"index": 123,
										"rawAnalysisId": 123,
										"rawAnalysisParametersId": 123,
										"lookupValue": "ABC",
										"lookup": [
												{
														"value": "ABC"
												}
										]
								}
						],
						"columns": [
,
(47,7,'LEFT','Call Date','Call_Date','Call Date',NULL,'100','Date_Range','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(48,7,'LEFT','Vendor Name','Vendor_Name','Vendor Name',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(49,7,'LEFT','Country','Country','Country',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(50,7,'LEFT','BTN','Billing_Telephone_Number','BTN',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(51,7,'LEFT','Called Number','Called_Number','Called Number',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(52,7,'LEFT','Currency','Currency','Currency',NULL,'100','String','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(53,7,'LEFT','Call Count','Call_Count','Call Count',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(54,7,'LEFT','MOU','Minutes_of_Usage','MOU',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(55,7,'LEFT','Charge in Local Currency','Charge_in_Local_Currency','Charge in Local Currency',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(56,7,'LEFT','FX Rate','FX_Rate','FX Rate',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),
(57,7,'LEFT','Charge in USD','Charge_in_USD','Charge in USD',NULL,'100','Number','N',NULL,'Y',NULL,NULL,NULL,NULL,NULL),

						{
										"align": "ABC",
										"label": "ABC",
										"name": "ABC",
										"pattern": "ABC",
										"size": "ABC",
										"type": "ABC",
										"aggregate": "ABC",
										"sortType": "ABC",
										"groupBy": "ABC",
										"criteria": "ABC",
										"alias": "ABC",
										"viewName": "ABC",
										"criteriaOption": "ABC",
										"renderCriteria": "ABC",
										"rawAnalysisId": 123,
										"rawAnalysisColumnsId": 123,
										"selected": true,
								}
						],
						"parametarised": true,
						"scheduled": true,
						"analysisSuperCategoryList": [
								"ABC"
						]
				}
		}
	},
	{
		"verb" : "read",
		"keys" : 
		[   
			{ "analysisId" : "" },
			{ "tenantId" : "" }
		]
	}
]	