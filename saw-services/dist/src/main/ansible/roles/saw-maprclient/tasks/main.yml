- name: Create MapR group
  group: name=mapr gid=5000 state=present
- name: Create MapR user
  user:
    name: mapr
    uid: "{{ saw_mapr_user_id | default('500') }}"
    group: mapr
    state: present
- name: Install MapR client
  yum: name=mapr-client
# Workaround: The MapR logging configuration refers to a file that is
# not writable by the "mapr" user, so change the path to a writable
# location.
- name: Set MapR log file path to writable location
  replace:
    path: /opt/mapr/conf/log4j.properties
    regexp: '^log.file=log4.log$'
    replace: 'log.file=/tmp/log4.log'
# Workaround: The Transport Service uses "mapr classpath" which drops
# certain Hadoop libraries entries if the "which" command is missing.
# So install it as a workaround.
- name: Install which for MapR classpath command
  yum: name=which state=present
