# Root
location = / {
    # Use landing page if it exists (for example in a local
    # development environment).  Otherwise default to redirecting to
    # SAW.
    proxy_read_timeout 600;
    try_files /dev/ @saw;
    port_in_redirect off;
}

location /dev/ {
    # Substitute public hostname in "proxy.pac"
    sub_filter_types application/x-ns-proxy-autoconfig;
    sub_filter '%public_hostname%' '$host';
}

location @saw {
    # Redirect to the SAW application
    rewrite ^/$ $scheme://$http_host/saw/ redirect;
}

# Workaround: Rewrite references to internal API to old location
# until Transport Service updated.
#rewrite ^/services/api/internal/(.*)$ ^/services/$1;
