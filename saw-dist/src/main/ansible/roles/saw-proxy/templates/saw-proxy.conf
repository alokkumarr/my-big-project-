# Root
location = / {
    # Use landing page if it exists (for example in a local
    # development environment).  Otherwise default to redirecting to
    # SAW Web.
    try_files /start/ @root;
}

location @root {
    # Redirect root to the SAW Web application
    rewrite ^/$ $scheme://$http_host/web/ redirect;
}

# Workaround: Rewrite references to internal API to old location
# until Transport Service updated.
#rewrite ^/services/api/internal/(.*)$ ^/services/$1;

# SAW Web
location /web/ {
    proxy_pass http://localhost:8080/saw/;
    proxy_read_timeout 600;
}
# SAW Services
location /services/ {
    proxy_pass http://localhost:9100/;
    proxy_read_timeout 600;
}
# SAW Security
location /security/ {
    proxy_pass http://localhost:9000/saw-security/;
    proxy_read_timeout 600;
}

# Large header setting
client_body_buffer_size 32k;
client_header_buffer_size 16k;
large_client_header_buffers 8 64k;
